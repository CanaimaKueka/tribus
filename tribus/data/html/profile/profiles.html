{% extends 'profile/base.html' %}
{% load i18n %}
{% block title %} Profile {% endblock %}
{% block content%}

<div class="jumbotron">
	<div class="container">
		<div class="row-fluid">
			<div class="span3">
                <div ng-controller="UserController">
					<span class="profile_avatar" ng-style="{'background-image': 'url(\''+user_gravatar+'\')'}"></span>
					<div class="space-36"></div>
	                {% block datos %}
	    			<hr>
	    			<ul>
						<p>{{ user_view.first_name }} {{user_view.last_name}}
						<p>{{ user_view.email }}
						<p>descripcion: {{ user_view.description }}
						<hr>
	                {% endblock %}
            	<hr>
				<legend></legend>
				</div>
			</div>
			<div class="span9">
				{% include 'profile/navbar.html' %}
                <legend></legend>

				<div class = "row-fluid">

					<div class="tabbable tabs">
						<ul class="nav nav-tabs" id="myTab3">

							<li class="">
								<a data-toggle="tab" href="#home3">
									<i class="pink icon-dashboard bigger-110"></i>
									Walk
									<span class="badge badge-danger">4</span>
								</a>
							</li>

							<li class="">
								<a data-toggle="tab" href="#profile3">
									<i class="blue icon-user bigger-110"></i>
									Edit Profile
								</a>
							</li>

							<li class="active">
								<a data-toggle="tab" href="#followsTag">
									<i class="icon-rocket"></i>
									Follows
								</a>
							</li>

							<li class="">
								<a data-toggle="tab" href="#followersTag">
									<i class="icon-rocket"></i>
									Followers
								</a>
							</li>							
						</ul>

						<div class="tab-content">
							<div id="home3" class="tab-pane">
					            	{% include 'tribs.html' %}
							</div>

							<div id="profile3" class="tab-pane ">
							    <form name = "Form" accept-charset="UTF-8" action="profile/done" autocomplete="off" novalidate method="post">
							        {% csrf_token %}
							        <ul class="unstyled row-fluid">
							            <li><label class ="span2 offset1">Email:</label>{{editForm.email}}</li>            
							            <li><label class ="span2 offset1">Descripcion:</label>{{editForm.descripcion}}</li>
							           
							        </ul>
							        <div class="span2 offset3" >
							        	<button class="btn btn-success btn-block" type="submit">Confirmar </button>
							    	</div>
							    </form>
							</div>

							<div id="followsTag" class="tab-pane active" >
								<div class = "row-fluid">								
									<input class = "span2 pull-right" name = "filtro" method = "GET" ng-model = 'query'></input>
									<label class = "pull-right">Search:</label>
								</div>


								<div class = "container-fluid" ng-controller= "FollowsController" >
									<ul >
										<div class = "span12"></div>
							        
										<li class = "span10 follows_list action_publisher " ng-repeat="follow in follows | filter: query | startFrom:currentPage*pageSize | limitTo:pageSize ">
											<span class= "span2 offset">
								                <a href="/profile/{% verbatim %}{{follow.username}}{%endverbatim %}"><span class="trib_avatar" ng-style="{'background-image': 'url(\''+convertmd5(follow.email)+'\')'}"></span></a>
								            </span>

											<span class= "span9 offset1">		
												<span class ="">
													<p>{% verbatim %}{{follow.first_name}} {{follow.last_name}}{% endverbatim %}</p>
								            	</span>	
												<span class ="">
													<p>{% verbatim %}@{{follow.username}}{% endverbatim %}</p>
								            	</span>
												<span class ="">
													<p>{% verbatim %}{{follow.email}}{% endverbatim %}</p>									
								            	</span>									            	
								            </span>
								            <span class ="pull-right" ng-onclick= >
													<p>dejar de seguir</p>									
								            	</span>									            	
								            </span>
							        	</li>

							        </ul>
										<div ng-if= "filtername.length==0 && follows.length>0" >
											<p> no tiene resultados </p>
										</div>

										<div ng-if= "filtername.length==0 && follows.length==0" >
											<p> no tiene seguidores </p>
										</div>											

							        <span class= " pull-right"  ng-hide = "filtername.length<=1">
							        	<hr noshade="noshade"/>
									    <button ng-disabled="currentPage == 0" ng-click="currentPage=currentPage-1">
									        Previous
									    </button >
									    {% verbatim %}{{currentPage+1}}/{{numberOfPages()}}{% endverbatim %}
									    <button ng-disabled="currentPage >= filtername.length/pageSize - 1" ng-click="currentPage= currentPage+1" >
									        Next   
									    </button>		     
									</span>
								</div>
							</div>

							<div id="followersTag" class="tab-pane" >
								<div class = "row-fluid">								
									<input class = "span2 pull-right" name = "filtro2" method = "GET" ng-model = 'query2'></input>
									<label class = "pull-right">Search:</label>
								</div>


								<div class = "container-fluid" ng-controller= "FollowersController" >
									<ul >
										<div class = "span12"></div>
							        
										<li class = "span10 follows_list action_publisher " ng-repeat="follow in followers | filter: query2 | startFrom:currentPage*pageSize | limitTo:pageSize ">
											<span class= "span2 offset">
								                <a href="/profile/{% verbatim %}{{follow.username}}{%endverbatim %}"><span class="trib_avatar" ng-style="{'background-image': 'url(\''+convertmd5(follow.email)+'\')'}"></span></a>
								            </span>

											<span class= "span9 offset1">		
												<span class ="">
													<p>{% verbatim %}{{follow.first_name}} {{follow.last_name}}{% endverbatim %}</p>
								            	</span>	
												<span class ="">
													<p>{% verbatim %}@{{follow.username}}{% endverbatim %}</p>
								            	</span>
												<span class ="">
													<p>{% verbatim %}{{follow.email}}{% endverbatim %}</p>									
								            	</span>									            	
								            </span>
								            <span class ="pull-right" ng-onclick= >
													<p>dejar de seguir</p>									
								            	</span>									            	
								            </span>
							        	</li>

							        </ul>
										<div ng-if= "filtername.length==0 && follows.length>0" >
											<p> no tiene resultados </p>
										</div>

										<div ng-if= "filtername.length==0 && follows.length==0" >
											<p> no tiene seguidores </p>
										</div>											

							        <span class= " pull-right"  ng-hide = "filtername.length<=1">
							        	<hr noshade="noshade"/>
									    <button ng-disabled="currentPage == 0" ng-click="currentPage=currentPage-1">
									        Previous
									    </button >
									    {% verbatim %}{{currentPage+1}}/{{numberOfPages()}}{% endverbatim %}
									    <button ng-disabled="currentPage >= filtername.length/pageSize - 1" ng-click="currentPage= currentPage+1" >
									        Next   
									    </button>		     
									</span>
								</div>
							</div>

						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>			

{% endblock %}


{% block scripts %}
    <script type="text/javascript">
        {% if user.is_authenticated %}
        var user_id = '{{ user.id }}';
        var user_username = '{{ user.username }}';
        var user_first_name = '{{ user.first_name }}';
        var user_last_name = '{{ user.last_name }}';
        var user_email = '{{ user.email }}';
        var user_gravatar = 'http://www.gravatar.com/avatar/'+md5(user_email)+'?d=mm&s=250&r=x';
        var userview_gravatar = "none";

        {% endif %}
		
        var userview_id = '{{ user_view.id }}';    
        var trib_limit_to = 0;
        var trib_offset = 0;
        var trib_add = 10;
        var trib_limit = 10;
        var trib_orderby = '-trib_pub_date';
        var controller_busy = false;


        var trib_save_success = '{% trans "Your message has been published." %}'
        var trib_save_error = '{% trans "There has been an error publishng your message. Please try again later." %}'
        var trib_delete_success = '{% trans "Your message has been deleted." %}'
        var trib_delete_error = '{% trans "There has been an error deleting your message. Please try again later." %}'
        var trib_add_error = '{% trans "There has been an error consulting more messages. Please try again later." %}'
        var comment_delete_success = '{% trans "Your comment has been deleted." %}'
        var comment_delete_error = '{% trans "There has been an error deleting your comment. Please try again later." %}'


        var follows_limit_to = 0;
        var follows_offset = 0;
        var follows_add = 10;
        var follows_limit = 10;
        var follows_orderby = 'username';   
    </script>
{% endblock %}